# Command Injection

## 1

The command is obviously being passed in as a string, so we can use a `;` to separate and add our own commands after the IP.

`http://localhost:31337/commandexec/example1.php?ip=127.0.0.1;cat /etc/passwd`

## 2

There is now a regex in place which checks for valid IP addresses. However, the regex is in multiline mode, so we can sneak our command in on the next line and still have it match. Because the commands are being passed to the shell, the new line causes the first command to execute, followed by the second command.

`http://localhost:31337/commandexec/example2.php?ip=127.0.0.1%0Acat /etc/passwd`

## 3

This example uses a regular expression to detect for a valid IP address. Sadly, we can't use the same shenanigans as before. If the input isn't a valid IP, it uses the PHP `header` function to create a redirect. However, just because the `header` function has been called, that doesn't mean the current script stops executing. By looking at the response of the first request (the one that returns the 302), we can see the output of our command.

`http://localhost:31337/commandexec/example3.php?ip=127.0.0.1;cat /etc/passwd`
